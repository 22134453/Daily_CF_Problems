**提示 1：** 前后缀需要满足什么条件？

**提示 2：** 如何计算方案数？

一个括号序列合法，等价于把左括号看成 $1$ ，右括号看成 $-1$ ，任意前缀和都非负，且整体和为 $0$ 。

于是，假设前缀部分的和为 $x$ ，则其加上中间部分的最小前缀和 $y$ 后应当非负。

我们考虑进行长度为 $i$ 的和为 $j$ 的前缀数量为 $dp[i][j]$ ，则这个 DP 的转移关系相当容易：考虑下一位是 $1$ 还是 $-1$ ，需要满足 $j$ 加上之非负，则进一步发生 $dp[i+1][j-1]$ 或 $dp[i+1][j+1]$ 的转移。

后缀部分的转移本质上是一样的，我们可以把后缀部分反转后，再把 $1$ 变成 $-1$ ， $-1$ 变成 $1$ 。

我们可以枚举前缀的长度和数值和。则前缀加后缀的总长度等于 $n-m$ ，且整体和为 $0$ ，再加上前缀部分的和 $x$ 与中间部分的最小前缀和的和非负，即可完成前缀后缀两部分的选择。

时间复杂度为 $\mathcal{O}((n-m)^2)$ 。